{% extends "base.html" %}

{% block content %}
<div class="min-h-screen py-12 px-6"
     style="background: linear-gradient(to bottom right, #1b3a4b, #204d5a, #19323c);">

    <div class="max-w-7xl mx-auto">

        <!-- Title -->
        <h1 class="text-5xl font-extrabold text-center text-transparent bg-clip-text 
                   bg-gradient-to-r from-blue-300 via-teal-200 to-indigo-200 
                   mb-14 tracking-tight drop-shadow-md">
            Explore Job Opportunities
        </h1>

        <!-- Filters Section -->
        <form method="GET" 
            class="sticky top-4 z-20 grid md:grid-cols-3 gap-6 mb-14 
                   bg-slate-900/60 text-gray-100 rounded-3xl shadow-xl p-8 
                   border border-slate-700 backdrop-blur-xl">

            <!-- Domain -->
            <div>
                <label class="block text-sm font-semibold text-gray-300 mb-2">Domain</label>
                <select name="domain" id="domain"
                    class="w-full rounded-lg bg-slate-800/80 border border-slate-700 
                           text-gray-200 px-4 py-2 focus:ring-2 focus:ring-teal-400 
                           focus:outline-none transition">
                    <option value="">All</option>
                    {% for d in domains %}
                        <option value="{{ d }}" {% if selected_domain == d %}selected{% endif %}>{{ d }}</option>
                    {% endfor %}
                </select>
            </div>

            <!-- Package (Ranges) -->
            <div>
                <label class="block text-sm font-semibold text-gray-300 mb-2">Package (LPA)</label>
                <select name="package" id="package"
                    class="w-full rounded-lg bg-slate-800/80 border border-slate-700 
                           text-gray-200 px-4 py-2 focus:ring-2 focus:ring-teal-400 
                           focus:outline-none transition">
                    <option value="">All</option>
                    <option value="0-5" {% if selected_package == "0-5" %}selected{% endif %}>0 ‚Äì 5 LPA</option>
                    <option value="5-10" {% if selected_package == "5-10" %}selected{% endif %}>5 ‚Äì 10 LPA</option>
                    <option value="10-20" {% if selected_package == "10-20" %}selected{% endif %}>10 ‚Äì 20 LPA</option>
                    <option value="20+" {% if selected_package == "20+" %}selected{% endif %}>20+ LPA</option>
                </select>
            </div>

            <!-- Location -->
            <div>
                <label class="block text-sm font-semibold text-gray-300 mb-2">Location</label>
                <select name="location" id="location"
                    class="w-full rounded-lg bg-slate-800/80 border border-slate-700 
                           text-gray-200 px-4 py-2 focus:ring-2 focus:ring-teal-400 
                           focus:outline-none transition">
                    <option value="">All</option>
                    {% for l in locations %}
                        <option value="{{ l }}" {% if selected_location == l %}selected{% endif %}>{{ l }}</option>
                    {% endfor %}
                </select>
            </div>

            <!-- Search Button -->
            <div class="md:col-span-3 text-center mt-4">
                <button type="submit"
                    class="inline-flex items-center bg-gradient-to-r from-teal-500 to-blue-600 
                           hover:from-teal-600 hover:to-blue-700 text-white px-10 py-3 
                           rounded-full font-semibold shadow-lg transition transform hover:scale-105">
                    üîç Search Jobs
                </button>
            </div>
        </form>

        <!-- Available Jobs -->
        <h2 class="text-3xl font-bold text-gray-100 mb-8">Available Positions</h2>
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-10 mb-16">
            {% if jobs %}
                {% for job in jobs %}
                <div class="bg-slate-900/70 text-gray-100 rounded-3xl shadow-lg 
                            hover:shadow-2xl hover:-translate-y-1 transition 
                            border border-slate-700 p-8 flex flex-col backdrop-blur-md">
                    <h2 class="text-xl font-semibold mb-1">{{ job.title }}</h2>
                    <p class="text-teal-300 text-sm mb-4">@ {{ job.company.name }}</p>
                    
                    <p class="text-gray-300 text-sm mb-4 line-clamp-3">{{ job.description }}</p>

                    <div class="flex flex-wrap gap-2 text-sm mb-4">
                        <span class="px-3 py-1 rounded-full bg-slate-800/80 border border-slate-700 text-gray-300">
                            üìç {{ job.location }}
                        </span>
                        <span class="px-3 py-1 rounded-full bg-green-900/70 border border-green-700 text-green-200">
                            üí∞ {{ job.package }}
                        </span>
                        <span class="px-3 py-1 rounded-full bg-blue-900/70 border border-blue-700 text-blue-200">
                            üè∑Ô∏è {{ job.domain }}
                        </span>
                    </div>

                    <p class="text-xs text-gray-400 mb-6">‚è≥ Deadline: {{ job.deadline }}</p>

                    <div class="mt-auto flex justify-between gap-3">
                        <a href="{% url 'job_detail' job.id %}"
                            class="bg-slate-800/70 hover:bg-slate-700 text-white px-5 py-2 
                                   rounded-lg text-sm font-medium shadow-sm transition">
                            Details
                        </a>
                        <a href="{% url 'apply_job' job.id %}"
                            class="bg-gradient-to-r from-teal-500 to-blue-600 hover:from-teal-600 hover:to-blue-700 
                                   text-white px-5 py-2 rounded-xl text-sm font-medium shadow-lg transition">
                            Apply
                        </a>
                    </div>
                </div>
                {% endfor %}
            {% else %}
                <div class="col-span-3 text-center bg-slate-900/70 text-gray-200 rounded-3xl shadow-lg 
                            p-12 border border-slate-700 backdrop-blur-md">
                    <p class="text-lg font-medium">üö´ No jobs found. Try adjusting filters.</p>
                </div>
            {% endif %}
        </div>

        <!-- My Applications -->
        <h2 class="text-3xl font-bold text-gray-100 mb-8">My Applications</h2>
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-10">
            {% if my_applications %}
                {% for app in my_applications %}
                <div class="bg-slate-900/70 text-gray-100 rounded-3xl shadow-lg border border-slate-700 
                            p-8 flex flex-col backdrop-blur-md">
                    <h2 class="text-xl font-semibold mb-1">{{ app.job.title }}</h2>
                    <p class="text-teal-300 text-sm mb-4">@ {{ app.job.company.name }}</p>
                    
                    <div class="flex flex-wrap gap-2 text-sm mb-4">
                        <span class="px-3 py-1 rounded-full bg-slate-800/80 border border-slate-700 text-gray-300">üìç {{ app.job.location }}</span>
                        <span class="px-3 py-1 rounded-full bg-green-900/70 border border-green-700 text-green-200">üí∞ {{ app.job.package }}</span>
                        <span class="px-3 py-1 rounded-full bg-blue-900/70 border border-blue-700 text-blue-200">üè∑Ô∏è {{ app.job.domain }}</span>
                    </div>

                    <p class="text-sm font-medium mb-4 
                        {% if app.status == 'Accepted' %}text-green-400
                        {% elif app.status == 'Pending' %}text-yellow-400
                        {% else %}text-red-400{% endif %}">
                        üìå Status: {{ app.status }}
                    </p>

                    <a href="{% url 'job_detail' app.job.id %}"
                        class="bg-slate-800/70 hover:bg-slate-700 text-white px-5 py-2 rounded-lg 
                               text-sm font-medium shadow-sm transition">
                        View Job
                    </a>
                </div>
                {% endfor %}
            {% else %}
                <div class="col-span-3 text-center bg-slate-900/70 text-gray-200 rounded-3xl shadow-lg 
                            p-12 border border-slate-700 backdrop-blur-md">
                    <p class="text-lg font-medium">üìù You haven‚Äôt applied to any jobs yet.</p>
                </div>
            {% endif %}
        </div>

    </div>
</div>
{% endblock %}
