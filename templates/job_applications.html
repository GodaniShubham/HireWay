<!-- HireWay_app/templates/job_applications.html -->
{% extends 'base.html' %}

{% block title %}HireWay - Job Applications{% endblock %}

{% block content %}
    <!-- Main Content -->
    <div class="container mx-auto mt-12 px-4">
        <h1 class="text-center mb-8 text-white">HireWay Job Applications</h1>

        <!-- Filter Section -->
        <div class="filter-section mb-12">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                <div>
                    <label for="domainSelect" class="block text-sm font-medium text-gray-300">Domain</label>
                    <select id="domainSelect" class="custom-select mt-2">
                        <option value="">All Domains</option>
                        <option value="software">Software</option>
                        <option value="marketing">Marketing</option>
                    </select>
                </div>
                <div>
                    <label for="packageSelect" class="block text-sm font-medium text-gray-300">Package</label>
                    <select id="packageSelect" class="custom-select mt-2">
                        <option value="">All Packages</option>
                        <option value="3-5">3-5 LPA</option>
                        <option value="5-8">5-8 LPA</option>
                        <option value="8+">8+ LPA</option>
                    </select>
                </div>
                <div>
                    <label for="locationSelect" class="block text-sm font-medium text-gray-300">Location</label>
                    <select id="locationSelect" class="custom-select mt-2">
                        <option value="">All Locations</option>
                        <option value="bangalore">Bangalore</option>
                        <option value="punjab">Punjab</option>
                        <option value="gujarat">Gujarat</option>
                    </select>
                </div>
                <div>
                    <label for="searchInput" class="block text-sm font-medium text-gray-300">Search Jobs</label>
                    <input type="text" id="searchInput" class="mt-2 block w-full bg-transparent border-gray-500 rounded-lg p-2 text-white placeholder-gray-400 focus:ring-2 focus:ring-blue-400" placeholder="Search jobs...">
                </div>
            </div>
        </div>

        <!-- Job Listings -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-16" id="jobListings">
            {% for job in jobs %}
                <div class="job-card animate-slideInUp" data-domain="{{ job.domain|lower }}" data-package="{{ job.package|lower|slice:':3' }}" data-location="{{ job.location|lower }}">
                    <h5 class="text-xl font-semibold text-white">{{ job.title }} - {{ job.company }}</h5>
                    <p class="text-gray-300 mt-2">{{ job.location }} | {{ job.package }}</p>
                    <p class="text-gray-400 mt-1">Eligibility: {{ job.eligibility }}</p>
                    <div class="mt-4 flex space-x-4">
                        <button class="apply-btn px-6 py-2 rounded-full text-sm" onclick="applyJob('{{ job.company }}')">Apply Now</button>
                        <button class="details-btn px-6 py-2 rounded-full text-sm" onclick="viewDetails('{{ job.company }}')">View Details</button>
                    </div>
                </div>
            {% empty %}
                <p class="text-center col-span-3 text-gray-300 text-lg">No jobs available at the moment.</p>
            {% endfor %}
        </div>

        <!-- My Applications Section -->
        <h2 class="text-center mb-8">My Applications</h2>
        <div class="overflow-x-auto">
            <table class="min-w-full bg-white bg-opacity-10 rounded-xl shadow-lg">
                <thead class="table-header">
                    <tr>
                        <th class="px-6 py-3 text-left text-gray-200 font-semibold">Company</th>
                        <th class="px-6 py-3 text-left text-gray-200 font-semibold">Role</th>
                        <th class="px-6 py-3 text-left text-gray-200 font-semibold">Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for app in applications %}
                        <tr class="hover:bg-white hover:bg-opacity-20 transition-colors duration-300">
                            <td class="px-6 py-4 text-white">{{ app.job.company }}</td>
                            <td class="px-6 py-4 text-white">{{ app.job.title }}</td>
                            <td class="px-6 py-4 {% if app.status == 'shortlisted' %}status-shortlisted{% elif app.status == 'interview_scheduled' %}status-interview{% elif app.status == 'offer_received' %}status-offer{% endif %}">
                                {{ app.get_status_display }}
                            </td>
                        </tr>
                    {% empty %}
                        <tr>
                            <td colspan="3" class="px-6 py-4 text-center text-gray-400 text-lg">No applications yet.</td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
{% endblock %}

{% block scripts %}
    <script>
        function filterJobs() {
            const domain = document.getElementById('domainSelect').value.toLowerCase();
            const packageRange = document.getElementById('packageSelect').value.toLowerCase();
            const location = document.getElementById('locationSelect').value.toLowerCase();
            const search = document.getElementById('searchInput').value.toLowerCase();

            const jobs = document.querySelectorAll('.job-card');
            jobs.forEach(job => {
                const jobDomain = job.dataset.domain;
                const jobPackage = job.dataset.package;
                const jobLocation = job.dataset.location;
                const jobText = job.innerText.toLowerCase();

                const matchesDomain = !domain || jobDomain.includes(domain);
                const matchesPackage = !packageRange || jobPackage.includes(packageRange);
                const matchesLocation = !location || jobLocation.includes(location);
                const matchesSearch = !search || jobText.includes(search);

                job.style.display = (matchesDomain && matchesPackage && matchesLocation && matchesSearch) ? 'block' : 'none';
            });
        }

        document.getElementById('domainSelect').addEventListener('change', filterJobs);
        document.getElementById('packageSelect').addEventListener('change', filterJobs);
        document.getElementById('locationSelect').addEventListener('change', filterJobs);
        document.getElementById('searchInput').addEventListener('input', filterJobs);

        function applyJob(company) {
            alert(`Applied to ${company} on HireWay!`);
        }

        function viewDetails(company) {
            alert(`Viewing details for ${company} on HireWay.`);
        }
    </script>
{% endblock %}